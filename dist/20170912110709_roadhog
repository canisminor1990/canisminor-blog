{"tag":["å‰ç«¯"],"filename":"20170912110709_roadhog","body":"\n\n\nç”¨ [roadhog](https://github.com/sorrycc/roadhog) æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå…¶ä¸­æ‰è¸©è¿‡å¤§å¤§å°å°è®¸å¤šå‘ï¼Œåˆå› ä¸ºå…¶ç‰ˆæœ¬æ›´æ–°è¯´æ˜åŸºæœ¬éƒ½ç¢ç‰‡å¼åœ°æ”¾åœ¨ releases é‡Œæˆ–è€…å¶å°”å‡ºç°åœ¨ issues é‡Œ ğŸ˜ ï¼Œæ‰€ä»¥å†³å®šå¼€ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚\n\n## Sass\n\nä» `1.0.0` å¼€å§‹å®Œæ•´åœ°æ”¯æŒäº† sass ï¼Œéœ€è‡ªè¡Œå¼•å…¥ sass-loader å’Œ node-sass ä¾èµ–ï¼Œæ–‡æ¡£æ²¡æœ‰å†™çš„åœ°æ–¹æ˜¯ sass çš„ webpack é…ç½®å¯ä»¥ç›´æ¥å†™åœ¨ roadhogrc é‡Œï¼ŒsourceMap å’Œ includePaths å‡å¯ç”¨ï¼š\n\n```js\nexport default {\n  sass: {\n    sourceMap: process.env.NODE_ENV === 'development',\n    includePaths: [\n      'node_modules',\n      'src/style'\n    ],\n  },\n  ...\n}\n```\n\n> è®¾ç½® `includePaths` åä½¿ç”¨ `@import` æ—¶æ— éœ€å¤„ç†è·¯å¾„, è®¾ç½®ä¸­è·¯å¾„ä¸‹çš„æ–‡ä»¶å¯ä»¥ç›´æ¥å¼•å…¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŠ å…¥å½“å‰ç›®å½•ä¸­æœ‰åŒåçš„æ–‡ä»¶ï¼Œé‚£å½“å‰ç›®å½•ä¸­çš„ä¼˜å…ˆçº§å°†ä¼šæ¯” includePaths ä¸­çš„é«˜ã€‚\n\n## Vendor\n\nVendor å¯ä»¥è§£å†³ webpack æ‰“åŒ…ä½“ç§¯è¿‡å¤§çš„é—®é¢˜ï¼Œæå–ä¸å˜çš„ç¬¬ä¸‰æ–¹åº“å•ç‹¬æ‰“åŒ…å¼•å…¥ï¼Œé¿å…æ¯æ¬¡æ‰“åŒ…é‡å¤ä¸‹è½½ã€‚è¦å¼€å¯æ­¤åŠŸèƒ½é¦–å…ˆåˆ›å»º `src/vendor.js` æ–‡ä»¶ï¼š\n\n```js\nimport 'react';\nimport 'react-dom';\nimport 'dva';\nimport 'dva-loading';\nimport 'history';\n\n// å¦‚æœè¦åŠ¨æ€å¼•å…¥antdè¿™ä¹ˆå†™\n\nimport antd from 'antd';\nconst { Icon, Layout, Button, Popover, Collapse, BackTop, message } = antd;\n```\n\nç„¶ååœ¨ .roadhogrc.js é‡Œåšå¦‚ä¸‹é…ç½®\n\n```js\nexport default {\n  entry: {\n    'index' : './src/index.js',\n    'common': './src/vendor.js'\n  },\n  multipage: true,\n  ...\n}\n```\n\n## Hash\n\nè¦å¼€å¯ hash å¿…é¡»å¼€å¯ ejs (HtmlWebpackPlugin) åŠŸèƒ½ï¼Œå­˜åœ¨ `src/index.ejs` å³å¼€å¯æ­¤åŠŸèƒ½ï¼Œç„¶ååœ¨ .roadhogrc.js ä¸­åŠ å…¥ `hash: true` å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¼€å¯ ejs åï¼š\n\n* åŸæœ‰çš„ index.html å°†å¤±æ•ˆï¼Œå‡å¯åˆ é™¤ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ° index.ejs ä¸­ã€‚\n* åœ¨ index.js ä¸­æ— éœ€å¼•å…¥ html.ejs æ–‡ä»¶\n* æ— éœ€æ‰‹åŠ¨å¼•å…¥`index.js` `index.scss` `common.scss` ç­‰æ–‡ä»¶\n\n## Roadhog.dll\n\nå¼€å¯ dll èƒ½å¾ˆå¤§ç¨‹åº¦æé«˜å¯åŠ¨å’Œç¼–è¯‘é¡¹ç›®çš„æ—¶é—´ï¼Œçº¦ 3 å€å·¦å³ï¼Œè¦å¼€å¯ dll æ”¯æŒéœ€è¦åšå¦‚ä¸‹é…ç½®ï¼š\n\n**.roadhogrc.js **ï¼š\n\n```js\nexport default {\n  dllPlugin: {\n    exclude: [\n      'babel-runtime'\n    ],\n    include: [\n      'dva/router',\n      'dva/saga',\n      'dva/fetch'\n    ],\n  },\n  ...\n}\n```\n\n**src/index.ejs**\n\n```ejs\n<body>\n  <div id=\"root\"></div>\n  <% if (process.env.NODE_ENV === 'development') { %>\n  <script type=\"text/javascript\" src=\"/roadhog.dll.js\"></script>\n  <% } %>\n</body>\n```\n\n**package.json**\n\n```json\n{\n  \"scripts\": {\n    \"build\": \"roadhog build\",\n    \"build:dll\": \"roadhog buildDll\"\n  }\n}\n```\n\nå¼€å¯ dll çš„åŠŸèƒ½è¯ï¼Œéœ€è¦ä¿è¯ dependencies é‡Œçš„åŒ…å’Œ vendor é‡Œçš„ä¸€è‡´ï¼Œå…¶ä»–æ”¾åœ¨ dev é‡Œï¼Œæˆ–è€…ç”¨ exclude è¿›è¡Œæ’é™¤ï¼Œå¦åˆ™å°†å‡ºç°è¯¸å¦‚æ‰¾ä¸åˆ° fs ä¹‹ç±»æŠ¥é”™ï¼Œæ¯æ¬¡å¢åŠ æ–°åŒ…éƒ½éœ€è¦é‡æ–°æ‰§è¡Œ `yarn build:dll`ã€‚\n\n## sw-precache\n\nå¼€å¯æ¸è¿›å¼ç¼“å­˜æé«˜ç½‘ç«™åŠ è½½é€Ÿåº¦ï¼Œé¦–é€‰æ·»åŠ  `sw-precache` åŒ…ï¼Œåœ¨ package.json ä¸­ä¿®æ”¹ï¼š\n\n```json\n{\n  \"scripts\": {\n    \"build\": \"roadhog build ; sw-precache --config=sw-precache-config.js\",\n    \"build:dll\": \"roadhog buildDll\"\n  }\n}\n```\n\nåœ¨æ ¹ç›®å½•åˆ›å»º sw-precache-config.js æ–‡ä»¶ï¼š\n\n```js\nmodule.exports = {\n  stripPrefix: 'dist/',\n  staticFileGlobs: [\n    'dist/img/**/*',\n    'dist/favicon/*',\n    'dist/font/*',\n    'dist/*common*',\n  ],\n  dontCacheBustUrlsMatching: /./,\n  swFilePath: 'dist/sw-precache.js',\n};\n```\n\nä¿®æ”¹ html.ejsï¼š\n\n```ejs\n<head>\n  ...\n  <% if (process.env.NODE_ENV !== 'development') { %>\n  <!--progressive-web-app-->\n  <script>\n    if ('serviceWorker' in navigator) navigator.serviceWorker.register('/precache.js');\n  </script>\n  <% } %>\n</head>\n```\n","title":"Roadhog è¸©å‘è®°å½•"}